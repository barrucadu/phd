\chapstart Concurrency is not in standard Haskell, so here we restrict our
interest to GHC.  In this chapter we give an overview of the concurrency
functionality we use.  These operations are available in the
\package{concurrency} library\footnote{Available at
\url{https://hackage.haskell.org/package/concurrency}.  It is a collection of
functionality provided by the \package{atomic-primops}, \package{base}, and
\package{stm} libraries.}.  We cover the basic use of
concurrency~\sref{concurrent_haskell-threads}, the memory
model~\sref{concurrent_haskell-mmodel}, software transactional
memory~\sref{concurrent_haskell-stm}, and finally
exceptions~\sref{concurrent_haskell-exc}.

Readers already familiar with Haskell's concurrency functionality may wish to
skip this chapter.

\section{Threads and Mutable Variables}
\label{sec:concurrent_haskell-threads}

\paragraph{Basic threading}
\todo{fork, forkWithUnmask, myThreadId}

\paragraph{Capabilities}
\todo{forkOn, forkOnWithUnmask, getNumCapabilities, setNumCapabilities}

\paragraph{Scheduling}
\todo{yield, threadDelay}

\paragraph{The \texttt{MVar} type}
\todo{newEmptyMVar, putMVar, tryPutMVar, readMVar, tryReadMVar, takeMVar,
tryTakeMVar}

\section{Shared References and the Memory Model}
\label{sec:concurrent_haskell-mmodel}

\paragraph{The \texttt{CRef} type}
\todo{newCRef, readCRef, writeCRef}

\paragraph{Memory model}
\todo{memory model, atomicModifyCRef, atomicWriteCRef}

\paragraph{Compare-and-swap}
\todo{readForCAS, peekTicket, casCRef, modifyCRefCAS}

\section{Software Transactional Memory}
\label{sec:concurrent_haskell-stm}

\paragraph{The \texttt{TVar} type}
\todo{newTVar, readTvar, writeTVar}

\paragraph{Aborting and retrying}
\todo{retry, orElse}

\paragraph{Executing transactions}
\todo{atomically}

\section{Exceptions}
\label{sec:concurrent_haskell-exc}

\paragraph{Synchronous exceptions}
\todo{throw, catch, mask, uninterruptibleMask}

\paragraph{Asynchronous exceptions}
\todo{throwTo, killthread}

\paragraph{Software transactional memory}
\todo{throwSTM, catchSTM}
