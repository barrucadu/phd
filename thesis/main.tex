\documentclass[openright,imperial,11pt]{octavo}

% University thesis style guide requires: A4 paper (which octavo
% doesn't quite do by default); table of contents (etc) in the table
% of contents; 1.5 line spacing; and numbered chapters.
\usepackage[BCOR=10mm,DIV=9,a4paper,pagesize]{typearea}
\usepackage{tocbibind}
\usepackage{setspace}

\onehalfspacing

\setcounter{secnumdepth}{2}
\setcounter{tocdepth}{1}

% Bibliography
\usepackage[
  citestyle=numeric-comp,
  sorting=ydnt,
  style=numeric,
]{biblatex}
\addbibresource{references.bib}

% Other packages
\usepackage[english]{babel}
\usepackage[toc]{appendix}
\usepackage[dvipsnames]{xcolor}
\usepackage{import}
\usepackage{multicol}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{csquotes}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{tikz}
\usepackage{wasysym}
\usepackage{placeins}
\usepackage{hyperref}
\hypersetup{
 colorlinks,
 citecolor=Red,
 linkcolor=Black,
 urlcolor=Blue
}

% Tables
\usepackage{booktabs}
\usepackage{tabularx}

% Headings
\usepackage{titlesec}
\titleformat{\section}[hang]{\FloatBarrier\normalfont\large}{\thesection.}{1em}{}
\titleformat{\subsection}[hang]{\normalfont\large}{\thesubsection.}{1em}{}
\titleformat*{\paragraph}{\bfseries}

% Fonts
\usepackage{inconsolata}
\usepackage{fontspec}
\setmainfont{equity}[
  % Files
  Path      = \string~/s/fonts/equity/ ,
  Extension = .otf ,
  % Fonts
  UprightFont     = Equity Text A Regular ,
  UprightFeatures = { SmallCapsFont = Equity Caps A Regular } ,
  BoldFont        = Equity Text A Bold ,
  BoldFeatures    = { SmallCapsFont = Equity Caps A Bold } ,
  ItalicFont      = Equity Text A Italic ,
  BoldItalicFont  = Equity Text A Bold Italic ,
  % Features
  Numbers = OldStyle ]

% Footnotes which are not ugly with multiple lines
\usepackage[hang]{footmisc}
\setlength\footnotemargin{8.5pt}

% Code
\usepackage{minted}
\renewcommand{\listoflistings}{%
  \cleardoublepage
  \phantomsection
  \addcontentsline{toc}{chapter}{\listoflistingscaption}%
  \listof{listing}{\listoflistingscaption}%
}
\DeclareCaptionSubType{listing}
\usemintedstyle{tango}
\setminted{fontsize=\footnotesize,linenos}

\usepackage{etoolbox}
\makeatletter
\pretocmd{\chapter}{\addtocontents{lol}{\protect\addvspace{10\p@}}}{}{}
\makeatother

% Quotes
\usepackage{xparse}
\NewDocumentEnvironment{bquote}{m}{\begin{displayquote}}{\par\noindent(#1)\end{displayquote}}

% Cross references
\newcommand{\fancyref}[2]{\hyperref[#2]{#1~\ref*{#2}}}
\newcommand{\partref}[1]{\fancyref{Part}{part:#1}}
\newcommand{\chpref}[1]{\fancyref{Chapter}{chp:#1}}
\newcommand{\secref}[1]{\fancyref{Section}{sec:#1}}
\newcommand{\appref}[1]{\fancyref{Appendix}{app:#1}}
\newcommand{\figref}[1]{\fancyref{Figure}{fig:#1}}
\newcommand{\tblref}[1]{\fancyref{Table}{tbl:#1}}
\newcommand{\lstref}[1]{\fancyref{Listing}{lst:#1}}
\newcommand{\sref}[1]{(\hyperref[sec:#1]{\S\ref*{sec:#1}})}

% Maths
\newcommand{\dependent}{\nleftrightarrow}

% Temporary
\newcommand{\todo}[1]{\emph{\color{red}{#1}}}
\usepackage{blindtext}

% Document metadata
\title{Systematic Techniques for Testing Concurrent and Distributed Functional Programs}
\author{Michael Walker}
\date{\todo{MONTH} 2018}

% Miscellaneous
\newcommand{\dejafu}{D\'{e}j\`{a}~Fu}
\newcommand{\package}[1]{\textbf{#1}\footnote{\url{https://hackage.haskell.org/package/#1}}}
\newcommand{\inlpackage}[1]{\textbf{#1} (\url{https://hackage.haskell.org/package/#1})}
\newcommand{\arr}{$\rightarrow$}

\begin{document}
% Use roman numbering.
\frontmatter

% Disable page headings.
\pagestyle{plain}

% Avoid gaps between chapters.
\makeatletter\@openrightfalse\makeatother

\input{frontmatter.tex}

\cleardoublepage

% Use arabic numbering.
\mainmatter

% Open chapters on right-side pages.
\makeatletter\@openrighttrue\makeatother

% Enable chapter headings at the top of the page.
\pagestyle{headings}

% The thesis!
\chapter{Introduction}
\label{chp:introduction}
\input{introduction.tex}

\part{Background and Review}
\label{part:review}

\chapter{Concurrent Haskell}
\label{chp:concurrent_haskell}
\input{concurrent_haskell.tex}

\chapter{Concurrency Testing}
\label{chp:sct}
\input{sct.tex}

\chapter{Property-based Testing}
\label{chp:property_testing}
\input{property_testing.tex}

\part{Testing Concurrent Programs}
\label{part:testing}

\chapter{\dejafu{}: Haskell Concurrency Testing}
\label{chp:dejafu}
\input{dejafu.tex}

\chapter{Scheduling Algorithms}
\label{chp:algorithms}
\input{algorithms.tex}

\part{Test Case Generation}
\label{part:properties}

\chapter{CoCo: Discovering Properties Automatically}
\label{chp:coco}
\input{coco.tex}

\chapter{Using CoCo Properties in \dejafu{}}
\label{chp:coco_and_dejafu}
\input{coco_and_dejafu.tex}

\part{Conclusions and Future Directions}
\label{part:end}

\chapter{Evaluation and Conclusions}
\label{chp:conclusions}
\input{conclusions.tex}

\chapter{Future Directions}
\label{chp:future_work}
\input{future_work.tex}

\begin{appendices}
\chapter{Haskell Quick Reference}
\label{app:haskell}
\import{appendix/}{haskell_quick_reference.tex}

\chapter{\dejafu{} Primitive Action Listing}
\label{app:primops}
\import{appendix/}{primops.tex}

\chapter{\dejafu{} Dependency Relation}
\label{app:deprel}
\import{appendix/}{deprel.tex}

\chapter{Swarm Scheduler Program Listing}
\label{app:swarm}
\import{appendix/}{swarm.tex}
\end{appendices}

\printbibliography[heading=bibintoc]

\end{document}
