\documentclass[openright,imperial,11pt]{octavo}

% University thesis style guide requires: A4 paper (which octavo
% doesn't quite do by default); table of contents (etc) in the table
% of contents; 1.5 line spacing; and numbered chapters.
\usepackage[BCOR=10mm,DIV=9,a4paper,pagesize]{typearea}
%\usepackage{tocbibind}
\usepackage{setspace}

\onehalfspacing

\setcounter{secnumdepth}{2}
\setcounter{tocdepth}{1}

% Other packages
\usepackage[english]{babel}
\usepackage[square]{natbib}
\usepackage{appendix}
\usepackage[dvipsnames]{xcolor}
\usepackage{epigraph}
\usepackage{hyperref}
\hypersetup{
 colorlinks,
 citecolor=Red,
 linkcolor=Black,
 urlcolor=Blue
}

% Fonts
\usepackage{fontspec}
\setmainfont{equity}[
  % Files
  Path      = \string~/s/fonts/equity/ ,
  Extension = .otf ,
  % Fonts
  UprightFont     = Equity Text A Regular ,
  UprightFeatures = { SmallCapsFont = Equity Caps A Regular } ,
  BoldFont        = Equity Text A Bold ,
  BoldFeatures    = { SmallCapsFont = Equity Caps A Bold } ,
  ItalicFont      = Equity Text A Italic ,
  BoldItalicFont  = Equity Text A Bold Italic ,
  % Features
  Numbers = OldStyle ]

% Epigraphs with author names
\newcommand{\epi}[4]{\epigraph{\textit{#1}}{#2\nocite{#4}\\\textsc{#3}}}

% Epigraphs on part pages
\makeatletter
\let\@epipart\@endpart
\renewcommand{\@endpart}{\thispagestyle{epigraph}\@epipart}
\makeatother
\newcommand{\epigraphpart}[5][400]{\epigraphhead[#1]{\epi{#2}{#3}{#4}{#5}}\thispagestyle{plain}}

% Chapter headings
\def\chapstart #1 #2 #3 {\textsc{#1 #2 #3} }

% Cross references
\newcommand{\partref}[1]{Part~\ref{part:#1}}
\newcommand{\chpref}[1]{Chapter~\ref{chp:#1}}
\newcommand{\secref}[1]{Section~\ref{sec:#1}}
\newcommand{\sref}[1]{(\S\ref{sec:#1})}

% Temporary
\newcommand{\todo}[1]{\emph{\color{red}{#1}}}
\usepackage{blindtext}

% Document metadata
\title{Systematic Techniques for Testing Concurrent and Distributed Functional Programs}
\author{Michael Walker}
\date{\todo{MONTH} 2018}

% Miscellaneous
\newcommand{\dejafu}{D\'{e}j\`{a}~Fu}

\begin{document}
% Use roman numbering.
\frontmatter

% Disable page headings.
\pagestyle{plain}

% Avoid gaps between chapters.
\makeatletter\@openrightfalse\makeatother

\input{frontmatter.tex}

\cleardoublepage

% Use arabic numbering.
\mainmatter

% Open chapters on right-side pages.
\makeatletter\@openrighttrue\makeatother

% Enable chapter headings at the top of the page.
\pagestyle{headings}

% The thesis!
\chapter{Introduction}
\label{chp:introduction}
\input{introduction.tex}

\epigraphpart{[\dejafu{} is] A martial art in which the user's limbs move in time as well as space
  [\ldots].  It is best described as ``the feeling that you have been kicked in the head this way
  before''.}{Thief of Time}{Terry Pratchett}{pratchett2001}
\part{Testing Concurrent Haskell Programs}
\label{part:dejafu}

\chapter{Concurrent Haskell}
\label{chp:concurrent_haskell}
\input{concurrent_haskell.tex}

\chapter{Systematic Concurrency Testing}
\label{chp:sct}
\input{sct.tex}

\chapter{Testing Concurrent Programs}
\label{chp:dejafu}
\input{dejafu.tex}

\chapter{Scheduling Algorithms}
\label{chp:algorithms}
\input{algorithms.tex}

\epigraphpart{It no longer matters who consider themselves the masters of events.  Events no longer
  obey their masters.}{Hyperion}{Dan Simmons}{simmons1989}
\part{Test Case Generation}
\label{part:coco}

\chapter{Property-based Testing}
\label{chp:property_testing}
\input{property_testing.tex}

\chapter{Discovering Properties Automatically}
\label{chp:coco}
\input{coco.tex}

\chapter{CoCo and \dejafu{}}
\label{chp:coco_and_dejafu}
\input{coco_and_dejafu.tex}

\epigraphpart{He had no longer any need for home, for he carried his Gormenghast within him.  All
  that he had sought was jostling within himself.  He had grown up.  What a boy had set out to seek
  a man had found, found by the act of living.}{Titus Alone}{Mervyn Peake}{peake1959}
\part{Conclusions and Future Directions}
\label{part:end}

\chapter{Conclusions}
\label{chp:conclusions}
\input{conclusions.tex}

\chapter{Future Directions}
\label{chp:future_work}
\input{future_work.tex}

\begin{appendices}
\end{appendices}

\bibliographystyle{plainnat}
\bibliography{references}
\end{document}
